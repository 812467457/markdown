# 网络编程面试考点

## 一、TCP的三次握手

### 1、传输控制协议TCP概述

* 面向连接的、可靠的、基于字节流的传输层通信协议
* 将应用层的数据流分割成报文段并发送给目标节点的TCP层
* 数据包都有序号，对方收到则发送ACK确认，未收到则重传
* 使用校验和来检验数据在传输中是否有错误

### 2、三次握手介绍

三次握手之后TCP会在两个应用建立一个全双工的通信连接，占用两个计算机之间的通信线路，直到被一方或双方关闭未知。全双工指：计算机A在给计算机B发送信息时计算机B也可以给计算机A发送信息。

### 3、三次握手流程图

![image-20200730233806011](http://picture.youyouluming.cn/image-20200730233806011.png)

* 第一次握手：建立连接从客户端发送一个SYN包（SYN=j）到服务器，进入SYN-SENT状态等待服务器确认
* 第二次握手：服务器收到客户端发送的SYN包，必须确认客户端的SYN（ACK=j+1），同时自己也发送一个SYN包（SYN=K），也就是发送了SYN+ACK包，此时服务器进入SYN-RCVD状态
* 第三次握手：客户端收到服务器的SYN+ACK包，向服务器发出确认包ACK（ack=k+1），此包发送完毕客户端和服务器进入ESTABLUSHED状态，完成三次握手

### 4、三次握手的原因

为了初始化Sequence Number的初始值，通信双方通知对方自己的Sequence Number，此号码作为以后通讯的序号，从而保证应用层接受的数据不会因网络的传输问题而乱序，并且TCP会用这个序号来拼接数据，因此在服务器回发给客户端的Sequence Number及第二次握手之后还需要发送确认报文给服务器，目的是告诉服务器客户端已经收到服务器的Sequence Number。

## 二、TCP四次挥手

### 1、四次挥手介绍

挥手是为了终止连接，客户端和服务器总共需要发送四个包以确认连接的断开。

### 2、四次挥手流程图

![image-20200731000836285](http://picture.youyouluming.cn/image-20200731000836285.png)

* 第一次挥手：客户端发送一个FIN，用来关闭客户端到服务器的数据传送，客户端进入FIN_WAIT_1状态
* 第二次挥手：服务器收到FIN后，发送一个ACK给客户端，确认序号为收到序号+1（和SYN相同，一个FIN占用一个序号），服务器进入CLOSE_WAIT状态
* 第三次挥手：服务器发送一个FIN，用来关闭服务器到客户端的数据传送，服务器进入LAST_ACK状态
* 第四次挥手：客户端收到FIN后，客户端进入TIME_WAIT状态，接着发送一个ACK给服务器，确认序号为收到序号+1，客户端进入CLOSED状态，完成四次挥手

### 3、存在TIME_WAIT状态的原因

* 确保有足够的时间让服务器收到ACK包
* 避免新旧连接混淆

### 4、四次挥手的原因

因为全双工，发送方和接收方都需要FIN报文和ACK报文，看上去两次挥手即可，但有一方是被动的，所以需要四次挥手。

## 三、UDP协议和TCP协议

### 1、UDP简介

特点：

* 面向非连接的协议，传输之前双端不建立连接，传输速度根据应用程序决定。
* 不维护连接状态，支持同时向多个客户端传输相同的信息
* 数据包头只有8个字节
* 吞吐量只受限于数据生成速率、传输速率以及性能
* 不保证可靠的交付，不需要维持复杂的链接状态

### 2、UDP协议和TCP协议的区别

* TCP面向连接，UDP面向无连接
* TCP比UDP可靠性高
* TCP保证有序性，UDP无法保证
* TCP传输速度比UDP慢
* TCP重量级,UDP轻量级

### 3、TCP的滑动窗口

RTT和RTO：

* RTT：发送一个数据包到收到对应的ACK,所花费的时间
* RTO：重传时间间隔

TCP使用滑动窗口做流量控制和乱序重排

* 保证TCP的可靠性
* 保证TCP的流控特性



## 四、HTTP协议

### 1、介绍

HTTP协议是超文本传输协议

特点:

* 支持客户/服务器模式
* 简单快速，客户端请求服务器时只需传输请求方法
* 灵活，http允许传输任意类型的数据
* 无连接，服务器收到连接并处理连接后等待一段时间无新的请求就断开连接
* 无状态，是指协议对于交互性场景没有记忆能力。

请求和响应的步骤

* 客户端连接到web服务器
* 发送http请求
* 服务器接受请求并返回http响应
* 释放连接TCP连接
* 客户端浏览器解析html内容

### 2、再浏览器地址栏键入url，按下回车后的经历的流程

* DNS解析：浏览器根据URL逐层查询DNS，解析URL域名对应的IP地址，DNS缓存依次是浏览器缓存、系统缓存、路由器缓存、IPS缓存、域名服务器缓存、顶级域名服务器缓存。从哪个缓存找到对应的IP就之间返回
* TCP连接：和服务器建立TCP连接，接着就是TCP的三次握手操作
* 发送HTTP请求：此处就是HTTP请求／响应的步骤
* 服务器处理请求并返回HTTP报文：服务器把带着html内容的报文发送给浏览器
* 浏览器解析渲染html页面
* 连接结束：四次挥手的步骤

### 3、HTTP状态码

常见状态码格式

* 1xx：指示信息--请求已接受，继续处理
* 2xx：成功--表示请求已经被成功接收
* 3xx：重定向--要完成请求必须进行更进一步的操作
* 4xx：客户端错误--请求有语法错误或请求无法实现
* 5xx：服务器端错误--服务器未能实现合法的请求

常见状态码

* 200：成功，正常返回信息
* 400：客户端请求有语法错误，不能被服务器解析
* 401：请求未经授权
* 403：服务器收到请求，但是拒绝提供服务
* 404：请求资源不存在，通常是url错误
* 500：服务器发送不可预期错误
* 503：服务器当前不能处理客户端请求，一段时间后可能恢复正常

### 4、get请求和post请求的区别

* HTTP报文层面：GET请求把请求信息放在URL，POST请求放在报文体中
* 数据库层面：GET请求符合幂等性（对数据库的一次操作或多次操作的结果是一致的）和安全性（对数据库的操作没有改变数据库的数据），POST不符合。
* 其他层面：GET请求可以被缓存、被储存，POST不行。

### 5、Cookie和Session的区别

Cookie简介：

* 是由服务器发给客户端的特殊信息，以文本的形式存放在客户端
* 客户端再次请求时，会把Cookie回发，信息存放在http请求头中
* 服务器接收到后，会解析cookie生成与客户端相对于的内容，比如记住用户名密码功能等。

Session简介：

* 时服务器端机制，在服务器上保存信息，会有一个session id
* 解析客户端请求并操作session id，按需保存状态信息

两者区别：

* Cookie数据存放在客户的浏览器上，Session数据存放在服务器上
* Session相对于 cookie更安全
* 若考虑减轻服务器负担，应该使用cookie

### 6、HTTP和HTTPS的区别

* HTTPS需要到CA申请证书，HTTP不需要
* HTTPS时密文传输数据，HTTP是明文传输
* 连接方式不同，HTTPS默认使用的是443断开，HTTP默认使用80端口
* HTTPS=HTTP+加密+认证+完整性保护，比HTTP安全



